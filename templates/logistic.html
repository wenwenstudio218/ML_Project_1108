{% extends "base.html" %}

{% block head %}
{{ super() }}
<title>邏輯斯回歸 - 離職預測</title>
<link rel="stylesheet" href="{{ url_for('static', filename='css/prediction.css') }}">
{% endblock %}

{% block content %}
<div class="page-header">
    <h1>邏輯斯回歸 (Logistic Regression)</h1>
    <p>調整下方的壓力特徵滑桿，即時預測員工的離職傾向機率。</p>
</div>

<div class="prediction-wrapper">

    <div class="controls-panel card-style">
        <h2 class="panel-title">壓力特徵控制器</h2>
        <div class="slider-group">
            <label for="feature1">
                <span>工作量壓力</span>
                <span class="slider-value" id="feature1-value">3</span>
            </label>
            <input type="range" id="feature1" class="slider" min="1" max="5" value="3" step="1">
        </div>
        <div class="slider-group">
            <label for="feature2">
                <span>組織風氣-申訴管道壓力</span>
                <span class="slider-value" id="feature2-value">3</span>
            </label>
            <input type="range" id="feature2" class="slider" min="1" max="5" value="3" step="1">
        </div>
    </div>

    <div class="results-panel card-style">
        <h2 class="panel-title">即時預測結果</h2>

        <div class="circle-percentage-container">
            <div class="circle-progress" id="circle-progress">
                <div class="circle-progress-inner">
                    <span id="risk-percentage-value">...</span>%
                </div>
            </div>
            <p class="circle-percentage-label">離職傾向機率</p>
        </div>

        <div class="risk-interpretation">
            <h3 id="risk-label">計算中...</h3>
            <p id="risk-interpretation">請拖動滑桿以查看分析</p>
        </div>
    </div>
</div>

<div class="chart-container card-style">
    <h2>特徵分佈散佈圖 (200筆隨機樣本)</h2>
    <div class="chart-controls">
        <button id="chart-filter-all" class="chart-filter-btn active">全部顯示</button>
        <button id="chart-filter-no" class="chart-filter-btn">僅未離職 (藍)</button>
        <button id="chart-filter-yes" class="chart-filter-btn">僅離職 (紅)</button>
    </div>
    <div class="chart-canvas-wrapper">
        <canvas id="scatterChart"></canvas>
    </div>
    <div class="chart-legend">
        <span class="legend-item legend-no">■ 未離職</span>
        <span class="legend-item legend-yes">■ 離職</span>
    </div>
</div>

<div class="info-blocks-wrapper">
    <div class="info-card card-style">
        <h3>模型評估指標 (測試集)</h3>
        <ul id="model-evaluation-list">
            <li><strong>召回率 (Recall):</strong> <span id="metric-recall">載入中...</span></li>
            <li><strong>F1-Score:</strong> <span id="metric-f1">載入中...</span></li>
            <li><strong>AUC 分數:</strong> <span id="metric-auc">載入中...</span></li>
        </ul>
    </div>

    <div class="info-card card-style">
        <h3>模型資訊</h3>
        <ul id="model-info-list">
            <li><strong>資料集:</strong> <span id="info-dataset-name">載入中...</span></li>
            <li><strong>總樣本數:</strong> <span id="info-total-samples">載入中...</span></li>
            <li><strong>訓練集大小:</strong> <span id="info-train-size">載入中...</span></li>
            <li><strong>測試集大小:</strong> <span id="info-test-size">載入中...</span></li>
            <li><strong>預測目標:</strong> <span id="info-target">載入中...</span></li>
        </ul>
    </div>

    <div class="info-card card-style">
        <h3 id="chart-info-title">圖表說明</h3>
        <p id="chart-info-description">載入中...</p>
    </div>
</div>

{% endblock %}

{% block code %}
<script src="{{ url_for('static', filename='vendor/chart.js/chart.umd.js') }}"></script>
<script src="{{ url_for('static', filename='js/logistic.js') }}"></script>
{% endblock%}